{"query":"create table Enrollments as select distinct 'v2.14 enrollment parents secondary' as version,  c.courseNumber || '_' || ss.publicId as courseId, ac.personId as personId, 'parent' as role,  s.termAbbreviation || '_' || s.beginningPeriodNumber as 'classGroup'  from Address_Contact as ac left join Section_Student as sst on sst.studentUniqueIdentifier=ac.studentUniqueIdentifier left join Section as s on (s.sectionNumber=sst.sectionNumber and sst.courseNumber=s.courseNumber and s.schoolCode=sst.schoolCode) left join Section_Staff as ss on (ss.sectionNumber=s.sectionNumber and sst.courseNumber=s.courseNumber and ss.schoolCode=sst.schoolCode) left join Course as c on (c.courseNumber=s.courseNumber and sst.courseNumber=s.courseNumber and c.schoolCode=sst.schoolCode)  where trim(personId) <> '' and trim(personId) <> '' and trim(classGroup) <> ''"},
{"query":"insert into Enrollments select distinct 'v2.14 enrollment staff secondary' as version,  c.courseNumber || '_' || ss.publicId as courseId, ss.staffUniqueIdentifier as personId,  case when ss.PrimaryInstructorFlag='Y' then 'editingteacher'  else 'teacher' end as role,  s.termAbbreviation || '_' || s.beginningPeriodNumber as 'classGroup'  from Section_Staff as ss left join Section as s on (s.sectionNumber=ss.sectionNumber and ss.courseNumber=s.courseNumber and s.schoolCode=ss.schoolCode) left join Course as c on (c.courseNumber=s.courseNumber and ss.courseNumber=s.courseNumber and c.schoolCode=ss.schoolCode)  where trim(courseId) <> '' and trim(personId) <> '' and trim(classGroup) <> '' "},
{"query":"insert into Enrollments select distinct 'v2.14 enrollment students secondary' as version,   c.courseNumber || '_' || ss.publicId as courseId, sst.studentUniqueIdentifier as personId, 'student' as role, s.termAbbreviation || '_' || s.beginningPeriodNumber as 'classGroup'  from Section_Student as sst left join Section as s on (s.sectionNumber=sst.sectionNumber and sst.courseNumber=s.courseNumber and s.schoolCode=sst.schoolCode) left join Section_Staff as ss on (ss.sectionNumber=s.sectionNumber and sst.courseNumber=s.courseNumber and ss.schoolCode=sst.schoolCode) left join Course as c on (c.courseNumber=s.courseNumber and sst.courseNumber=s.courseNumber and c.schoolCode=sst.schoolCode)  where trim(courseId) <> '' and trim(personId) <> '' and trim(classGroup) <> ''"},
{"query":"create table NewCourses as select distinct 'v2.14 new courses secondary' as version,  c.courseAbbreviation || '_' || ss.lastName || '_' || ss.firstName as courseName, c.courseAbbreviation || '_' || c.courseNumber || '_' || ss.publicId as shortName, c.courseNumber || '_' || ss.publicId as courseId, c.courseDesc as summary,  '' as template, '' as startDate, '' as visibility, ss.schoolCode as categoryPath, ss.schoolCode as categoryId, ss.schoolCode as categoryName, ss.schoolCode as categoryDescription  from Course as c left join Section as s on s.courseNumber=c.courseNumber left join Section_Staff as ss on (ss.sectionNumber=s.sectionNumber and ss.courseNumber=s.courseNumber)  where trim(courseName) <> '' and trim(shortName) <> '' and trim(courseId) <> ''"},
{"query":"create table Parents as select distinct 'v2.14 parent primary' as version,  j.personId as personId, j.studentUniqueIdentifier as studentUniqueIdentifier, 'parent' as role  from Address_Contact as j  where trim(personId) <> '' and trim(studentUniqueIdentifier) <> ''"},
{"query":"create table Users as select distinct 'v2.14 user parents primary and secondary' as version,  j.personId as personId, j.userName as userName, 'Te$tUs3r' as password, j.contactFirstName as firstName, j.contactLastName as lastName, j.contactEmail as email,  '' as city, '' as street, '' as phone1, '' as phone2, '' as grade, '' as gradYear,  j.schoolCode as schoolCode, 'PARENT' as department, 'US' as country, '' as description  from Address_Contact as j  where trim(personId) <> '' and trim(userName) <> '' and trim(password) <> '' and trim(firstName) <> '' and trim(lastName) <> '' and trim(email) <> '' "},
{"query":"insert into Users select distinct 'v2.14 user staff primary and secondary' as version,  j.staffUniqueIdentifier as personId, j.staffUniqueIdentifier as userName, 'Te$tUs3r' as password, j.firstName as firstName, j.lastName as lastName, j.lastName || '_' || j.firstName || '@emailaddress.edu' as email,  '' as city, '' as street, '' as phone1, '' as phone2, '' as grade, '' as gradYear,  j.schoolCode as schoolCode, 'STAFF' as department, 'US' as country, '' as description  from JMC_User as j  where trim(personId) <> '' and trim(userName) <> '' and trim(password) <> '' and trim(firstName) <> '' and trim(lastName) <> '' and trim(email) <> '' "},
{"query":"insert into Users select  distinct 'v2.14 user students secondary' as version,  sb.studentUniqueIdentifier as personId, sb.lastName || '_' || sb.firstName || '_' || substr(sb.studentUniqueIdentifier, 0, 4) as userName, 'Te$tUs3r' as password, sb.firstName as firstName, sb.lastName as lastName, sb.lastName || '_' || sb.firstName || '@emailadr.edu' as email, ac.city as city, ac.address1 as street, ac.contactPhone1 as phone1, ac.contactPhone2 as phone2, sb.gradeLevel as grade, sb.graduationYear as gradYear, sb.schoolCode as schoolCode, 'STUDENT' as department, 'US' as country, '' as description   from Student_Base as sb left join Address_Contact as ac on  (ac.studentUniqueIdentifier=sb.studentUniqueIdentifier and LOWER(ac.addressTypeCode)=LOWER('primary1'))  where trim(personId) <> '' and trim(userName) <> '' and trim(password) <> '' and trim(firstName) <> '' and trim(lastName) <> '' and trim(email) <> ''  "}
