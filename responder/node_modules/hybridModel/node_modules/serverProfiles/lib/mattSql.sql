
if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Section' and TABLE_SCHEMA='LP')
DROP TABLE LP.Section;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Section_Staff' and TABLE_SCHEMA='LP')
DROP TABLE LP.Section_Staff;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Section_Student' and TABLE_SCHEMA='LP')
DROP TABLE LP.Section_Student;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='StudentGrade_Levels' and TABLE_SCHEMA='LP')
DROP TABLE LP.StudentGrade_Levels;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Student_Base' and TABLE_SCHEMA='LP')
DROP TABLE LP.Student_Base;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Student_Attendance' and TABLE_SCHEMA='LP')
DROP TABLE LP.Student_Attendance;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Student_Discipline' and TABLE_SCHEMA='LP')
DROP TABLE LP.Student_Discipline;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Student_Enrollment' and TABLE_SCHEMA='LP')
DROP TABLE LP.Student_Enrollment;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Address_Contact' and TABLE_SCHEMA='LP')
DROP TABLE LP.Address_Contact;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='User_Base' and TABLE_SCHEMA='LP')
DROP TABLE LP.User_Base;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='User_Role' and TABLE_SCHEMA='LP')
DROP TABLE LP.User_Role;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Standard_Grades' and TABLE_SCHEMA='LP')
DROP TABLE LP.Standard_Grades;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Standard_Courses' and TABLE_SCHEMA='LP')
DROP TABLE LP.Standard_Courses;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Student_Grades' and TABLE_SCHEMA='LP')
DROP TABLE LP.Student_Grades;
go

if exists (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' and TABLE_NAME='Course' and TABLE_SCHEMA='LP')
DROP TABLE LP.Course;
go


--================
DECLARE @schemaVersion nvarchar(5);
SET @schemaVersion='v1.00';


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"schoolCode" as 'schoolCode',
"sectionNumber" as 'sectionNumber',
"courseNumber" as 'courseNumber',
"termAbbrev" as 'termAbbreviation',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"grade" as 'gradeLevel',
"beginDate" as 'beginDate',
"endDate" as 'endDate',
"location" as 'location',
"homeroomFlag" as 'homeroomFlag',
"begPeriodNum" as 'beginningPeriodNumber',
"endPeriodNum" as 'endPeriodNumber',
"credit" as 'credit',
"teamCode" as 'teamCode',
"track" as 'track',
@schemaVersion as 'schemaVersion'
INTO LP.Section
FROM ext.ExtractSection;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"schoolCode" as 'schoolCode',
"staffUniqueIdentifier" as 'staffUniqueIdentifier',
"localStaffCode" as 'localStaffCode',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"sectionNumber" as 'sectionNumber',
"courseNumber" as 'courseNumber',
"grade" as 'gradeLevel',
"primaryInstructorFlag" as 'primaryInstructorFlag',
"lastName" as 'lastName',
"middleName" as 'middleName',
"firstName" as 'firstName',
@schemaVersion as 'schemaVersion'
INTO LP.Section_Staff
FROM ext.ExtractSectionStaff;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"schoolCode" as 'schoolCode',
"studentUniqueIdentifier" as 'studentUniqueIdentifier',
"stateStudentNumber" as 'stateStudentIdentifier',
"localStudentNumber" as 'localStudentIdentifier',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"sectionNumber" as 'sectionNumber',
"courseNumber" as 'courseNumber',
"gradeLevel" as 'gradeLevel',
"entryDate" as 'entryDate',
"withdrawalDate" as 'withdrawalDate',
"entryType" as 'entryType',
"withdrawalType" as 'withdrawalType',
@schemaVersion as 'schemaVersion'
INTO LP.Section_Student
FROM ext.ExtractSectionStudent;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"studentUniqueIdentifier" as 'studentUniqueIdentifier',
"stateStudentNumber" as 'stateStudentIdentifier',
"localStudentNumber" as 'localStudentIdentifier',
"courseNumber" as 'courseNumber',
"termAbbrev" as 'termAbbreviation',
"subjectAreaDepartment" as 'subjectAreaDepartment',
"gradeLevel" as 'gradeLevel',
"creditsEarned" as 'creditsEarned',
"creditsAttempted" as 'creditsAttempted',
"gradeMark" as 'gradeMark',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"schoolCode" as 'schoolCode',
"courseDesc" as 'courseDesc',
@schemaVersion as 'schemaVersion'
INTO LP.StudentGrade_Levels
FROM ext.ExtractStudentGrades;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"schoolCode" as 'schoolCode',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"studentUniqueIdentifier" as 'studentUniqueIdentifier',
"stateStudentNumber" as 'stateStudentIdentifier',
"localStudentNumber" as 'localStudentIdentifier',
"gradeLevel" as 'gradeLevel',
"graduationYear" as 'graduationYear',
"studentStatus" as 'studentStatus',
"lastName" as 'lastName',
"middleName" as 'middleName',
"firstName" as 'firstName',
"suffix" as 'suffix',
"prefix" as 'prefix',
"fullName" as 'fullName',
"preferredName" as 'preferredName',
"lastSchoolAttended" as 'lastSchoolAttended',
"concurrentEnrollment" as 'concurrentEnrollment',
"birthDate" as 'birthDate',
"selfGuardianFlag" as 'selfGuardianFlag',
"gender" as 'gender',
"ssn" as 'socialSecurityNumber',
"birthPlace" as 'birthPlace',
"birthState" as 'birthState',
"birthCountry" as 'birthCountry',
"ethnicityCode" as 'ethnicityCode',
@schemaVersion as 'schemaVersion'
INTO LP.Student_Base
FROM ext.ExStudentBase;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"studentUniqueIdentifier" as 'studentUniqueIdentifier',
"stateStudentNumber" as 'stateStudentIdentifier',
"localStudentNumber" as 'localStudentIdentifier',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"schoolCode" as 'schoolCode',
"attendanceTimeUnit" as 'attendanceTimeUnit',
"termAbbrev" as 'termAbbreviation',
"attendanceCategory" as 'attendanceCategory',
"attendanceType" as 'attendanceType',
"attendanceCode" as 'attendanceCode',
"attendanceDate" as 'attendanceDate',
"periodCode" as 'periodCode',
"timeIn" as 'timeIn',
"timeOut" as 'timeOut',
"note" as 'note',
@schemaVersion as 'schemaVersion'
INTO LP.Student_Attendance
FROM ext.ExtractStudentAttendance;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"studentUniqueIdentifier" as 'studentUniqueIdentifier',
"stateStudentNumber" as 'stateStudentIdentifier',
"localStudentNumber" as 'localStudentIdentifier',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"schoolCode" as 'schoolCode',
"disciplineTimeUnit" as 'disciplineTimeUnit',
"termAbbrev" as 'termAbbreviation',
"disciplineCategory" as 'disciplineCategory',
"disciplineCode" as 'disciplineCode',
"disciplineDate" as 'disciplineDate',
"dispositionCode" as 'dispositionCode',
"dispositionBeginDate" as 'dispositionBeginDate',
"dispositionEndDate" as 'dispositionEndDate',
"note" as 'note',
"incidentTime" as 'incidentTime',
"incidentLocation" as 'incidentLocation',
@schemaVersion as 'schemaVersion'
INTO LP.Student_Discipline
FROM ext.ExtractStudentDiscipline;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"studentUniqueIdentifier" as 'studentUniqueIdentifier',
"stateStudentNumber" as 'stateStudentIdentifier',
"localStudentNumber" as 'localStudentIdentifier',
"schoolCode" as 'schoolCode',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"gradeLevel" as 'gradeLevel',
"entryDate" as 'entryDate',
"withdrawalDate" as 'withdrawalDate',
"entryTypeCode" as 'entryTypeCode',
"withdrawalTypeCode" as 'withdrawalTypeCode',
"studentResidentDistrictCode" as 'studentResidentDistrictCode',
"studentResidentDistrictType" as 'studentResidentDistrictType',
"studentResidentSchoolCode" as 'studentResidentSchoolCode',
"stateAidCategory" as 'stateAidCategory',
"lastLocationOfAttendance" as 'lastLocationOfAttendance',
"percentEnrolled" as 'percentEnrolled',
"attendanceDays" as 'attendanceDays',
"membershipDays" as 'membershipDays',
"postSecondaryOption" as 'postSecondaryOption',
"PSEOHighSchoolParticipationHrs" as 'pseoHighSchoolParticipationHrs',
"homeBoundServiceIndicator" as 'homeboundServiceIndicator',
"specialEducationEvaluationStatus" as 'specialEducationEvaluationStatus',
"specialEdInstructionalSetting" as 'specialEducationInstructionalSetting',
"lep" as 'lep',
"lepBeginDate" as 'lepBeginDate',
"giftedTalentedPartiicipation" as 'giftedTalentedParticipation',
"gender" as 'gender',
"ethnicityCode" as 'ethnicityCode',
"birthDate" as 'birthDate',
"homePrimaryLanguage" as 'homePrimaryLanguage',
"primaryDisability" as 'primaryDisability',
"transportationCategory" as 'transportationCategory',
"economicIndicator" as 'economicIndicator',
"migrantIndicator" as 'migrantIndicator',
"studentTitle1Indicator" as 'studentTitle1Indicator',
"homelessStudentFlag" as 'homelessStudentFlag',
"transportingDistrictCode" as 'transportingDistrictCode',
"transportingDistrictType" as 'transportingDistrictType',
"wardOfStateFlag" as 'wardOfStateFlag',
"independentStudyFlag" as 'independentStudyFlag',
"supplementalEducationServices" as 'supplementalEducationServices',
"specialEnrollmentCode" as 'specialEnrollmentCode',
"primarySchoolFlag" as 'primarySchoolFlag',
"specEdFlag" as 'specialEducationFlag',
"flag504" as '504Flag',
"track" as 'track',
"teamCode" as 'teamCode',
"promotionStatus" as 'promotionStatus',
"programOfStudy" as 'programOfStudy',
"enrollmentStatus" as 'enrollmentStatus',
@schemaVersion as 'schemaVersion'
INTO LP.Student_Enrollment
FROM ext.ExStudentEnrollment;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"StudentCode" as 'studentUniqueIdentifier',
"MARSSID" as 'marssId',
"localStudentNumber" as 'localStudentIdentifier',
"UniqueStaffCode" as 'staffUniqueIdentifier',
"schoolCode" as 'schoolCode',
"AddressTypeCode" as 'addressTypeCode',
"Address1" as 'address1',
"Address2" as 'address2',
"Address3" as 'address3',
"City" as 'city',
"StateName" as 'stateName',
"StateCode" as 'stateCode',
"ZipCode" as 'zipCode',
"CountyCode" as 'countyCode',
"ContactCode" as 'contactCode',
"ContactLegalCode" as 'contactLegalCode',
"ContactExtraMailingCode" as 'contactExtraMailingCode',
"ContactSequence" as 'contactSequence',
"ContactFirstName" as 'contactFirstName',
"ContactMiddleName" as 'contactMiddleName',
"ContactLastName" as 'contactLastName',
"ContactFullName" as 'contactFullName',
"ContactPhone1" as 'contactPhone1',
"ContactPhone2" as 'contactPhone2',
"ContactPhone3" as 'contactPhone3',
"Phone1Type" as 'phone1Type',
"Phone2Type" as 'phone2Type',
"Phone3Type" as 'phone3Type',
"ContactEMail" as 'contactEmail',
@schemaVersion as 'schemaVersion'
INTO LP.Address_Contact
FROM ext.ExContact;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"staffUniqueIdentifier" as 'staffUniqueIdentifier',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"employeeID" as 'employeeIdentifier',
"localStaffCode" as 'localStaffCode',
"schoolCode" as 'schoolCode',
"lastName" as 'lastName',
"middleName" as 'middleName',
"firstName" as 'firstName',
"fullName" as 'fullName',
"email" as 'email',
"department1" as 'department1',
"department2" as 'department2',
"department3" as 'department3',
"department4" as 'department4',
"status" as 'status',
"primaryLocationFlag" as 'primarySchoolFlag',
"loginName" as 'loginName',
"passward" as 'password',
"defaultPassword" as 'defaultPassword',
@schemaVersion as 'schemaVersion'
INTO LP.User_Base
FROM ext.ExUserBase;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"staffUniqueIdentifier" as 'staffUniqueIdentifier',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"schoolCode" as 'schoolCode',
@schemaVersion as 'schemaVersion'
INTO LP.User_Role
FROM ext.ExUserRole;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"studentUniqueIdentifier" as 'studentUniqueIdentifier',
"stateStudentNumber" as 'stateStudentIdentifier',
"localStudentNumber" as 'localStudentIdentifier',
"courseNumber" as 'courseNumber',
"termAbbrev" as 'termAbbreviation',
"subjectAreaDepartment" as 'subjectAreaDepartment',
"gradeLevel" as 'gradeLevel',
"creditsEarned" as 'creditsEarned',
"creditsAttempted" as 'creditsAttempted',
"gradeMark" as 'gradeMark',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"schoolCode" as 'schoolCode',
"courseDesc" as 'courseDesc',
"sectionNumber" as 'sectionNumber',
@schemaVersion as 'schemaVersion'
INTO LP.Standard_Grades
FROM ext.ExtractStandardGrades;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"schoolCode" as 'schoolCode',
"courseNumber" as 'courseNumber',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"courseDesc" as 'courseDesc',
"courseAbbrev" as 'courseAbbreviation',
"subjectAreaDepartment" as 'subjectAreaDepartment',
"credit" as 'credit',
"gradeMinimum" as 'gradeMinimum',
"gradeMaximum" as 'gradeMaximum',
@schemaVersion as 'schemaVersion'
INTO LP.Standard_Courses
FROM ext.ExtractStandardCourses;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"studentUniqueIdentifier" as 'studentUniqueIdentifier',
"stateStudentNumber" as 'stateStudentIdentifier',
"localStudentNumber" as 'localStudentIdentifier',
"courseNumber" as 'courseNumber',
"termAbbrev" as 'termAbbreviation',
"subjectAreaDepartment" as 'subjectAreaDepartment',
"gradeLevel" as 'gradeLevel',
"creditsEarned" as 'creditsEarned',
"creditsAttempted" as 'creditsAttempted',
"gradeMark" as 'gradeMark',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"schoolCode" as 'schoolCode',
"courseDesc" as 'courseDesc',
@schemaVersion as 'schemaVersion'
INTO LP.Student_Grades
FROM ext.ExStudentGrades;


SELECT
"districtCode" as 'districtCode',
"districtType" as 'districtType',
"schoolCode" as 'schoolCode',
"courseNumber" as 'courseNumber',
"schoolYearBegin" as 'schoolYearBegin',
"schoolYearEnd" as 'schoolYearEnd',
"courseDesc" as 'courseDesc',
"courseAbbrev" as 'courseAbbreviation',
"subjectAreaDepartment" as 'subjectAreaDepartment',
"credit" as 'credit',
"gradeMinimum" as 'gradeMinimum',
"gradeMaximum" as 'gradeMaximum',
@schemaVersion as 'schemaVersion'
INTO LP.Course
FROM ext.ExtractCourse;

